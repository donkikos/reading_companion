services:
  app:
    image: epub_ai_reader_ralph_app

  codex:
    build:
      context: .
      dockerfile: Dockerfile.codex
    image: epub_ai_reader_ralph_codex
    working_dir: /app
    init: true
    environment:
      CODEX_HOME: /app/.codex
      QDRANT_HOST: qdrant
      OLLAMA_BASE_URL: http://ollama:11434
    volumes:
      - ./:/app
      - ./.codex_container/config.toml:/app/.codex/config.toml:ro
      - ./.codex_container/auth.json:/app/.codex/auth.json:ro
      - ./skills:/app/.codex/skills:ro
    stdin_open: true
    tty: true
